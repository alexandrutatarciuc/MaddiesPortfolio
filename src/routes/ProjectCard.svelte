<script lang="ts">
	import { scale } from 'svelte/transition';
	import { goto } from '$app/navigation';

	export let imgUrl: string;
	export let title: string;
	export let tags: string;
	export let projectUrl: string;

	let cursorX: number = 0;
	let cursorY: number = 0;
	let showCursor: boolean = false;

	const updatePosition = (e: MouseEvent) => {
		const relativeWrapper = (e.currentTarget as HTMLDivElement).getBoundingClientRect();
		cursorX = e.clientX - relativeWrapper.x;
		cursorY = e.clientY - relativeWrapper.y;
	};

	const handleInteractionStart = () => {
		showCursor = true;
	};

	const handleInteractionEnd = () => {
		showCursor = false;
	};

	function navigateToProject(): void {
		goto(`projects/${projectUrl}`);
	}
</script>

<div class="flex flex-col gap-6">
	<!-- svelte-ignore a11y-mouse-events-have-key-events -->
	<!-- svelte-ignore a11y-no-noninteractive-element-interactions -->
	<!-- svelte-ignore a11y-click-events-have-key-events -->
	<div
		class="relative"
		role="img"
		aria-label={title}
		on:mouseover={handleInteractionStart}
		on:mousemove={updatePosition}
		on:mouseout={handleInteractionEnd}
		on:click|preventDefault={navigateToProject}
		>
		<img src={imgUrl} alt={title} class="object-cover h-full w-full aspect-video hover:cursor-none " />
		{#if showCursor}
			<svg
				id="customCursor"
				transition:scale
				width="120"
				height="120"
				viewBox="0 0 120 120"
				fill="none"
				xmlns="http://www.w3.org/2000/svg"
				style="top: {cursorY}px; left: {cursorX}px;">
				<path
					d="M120 60C120 54.0684 115.209 49.0494 109.049 49.0494H100.608L107.909 44.7148C113.156 41.749 114.981 35.1331 111.787 29.8859C108.821 24.6388 102.205 22.8137 96.9582 26.0076L89.6578 30.3422L93.9924 23.0418C96.9582 17.7947 95.1331 11.1787 90.1141 8.21293C84.8669 5.24715 78.251 7.07224 75.2852 12.0913L70.9506 19.3916V10.9506C70.9506 5.01901 66.1597 0 60 0C54.0684 0 49.0494 4.79088 49.0494 10.9506V19.3916L44.7148 12.0913C41.7491 6.84411 35.1331 5.01901 29.8859 8.21293C24.6388 11.1787 22.8137 17.7947 26.0076 23.0418L30.3422 30.3422L23.0418 26.0076C17.7947 23.0418 11.1787 24.8669 8.21293 29.8859C5.24715 35.1331 7.07224 41.749 12.0913 44.7148L19.3916 49.0494H10.9506C5.01901 49.0494 0 53.8403 0 60C0 65.9316 4.79088 70.9506 10.9506 70.9506H19.3916L12.0913 75.2852C6.84411 78.251 5.01901 84.8669 8.21293 90.1141C11.1787 95.3612 17.7947 97.1863 23.0418 93.9924L30.3422 89.6578L26.0076 96.9582C23.0418 102.205 24.8669 108.821 29.8859 111.787C35.1331 114.753 41.7491 112.928 44.7148 107.909L49.0494 100.608V109.049C49.0494 114.981 53.8403 120 60 120C65.9316 120 70.9506 115.209 70.9506 109.049V100.608L75.2852 107.909C78.251 113.156 84.8669 114.981 90.1141 111.787C95.3612 108.821 97.1863 102.205 93.9924 96.9582L89.6578 89.6578L96.9582 93.9924C102.205 96.9582 108.821 95.1331 111.787 90.1141C114.753 84.8669 112.928 78.251 107.909 75.2852L100.608 70.9506H109.049C115.209 70.9506 120 66.1597 120 60Z"
					fill="#111111" />
				<path
					d="M47.7542 57L50.9342 48.6H52.6982L49.3622 57H47.7542ZM47.5742 57L44.2262 48.6H45.9902L49.1822 57H47.5742ZM53.9424 57V48.6H55.5864V57H53.9424ZM57.6511 57V48.6H59.2951V57H57.6511ZM58.8991 57V55.5H63.0151V57H58.8991ZM58.8991 53.472V52.008H62.4631V53.472H58.8991ZM58.8991 50.1V48.6H62.9671V50.1H58.8991ZM71.6895 57L74.1015 48.6H75.7695L73.2615 57H71.6895ZM66.6255 57L64.1415 48.6H65.8095L68.1975 57H66.6255ZM66.8415 57L69.1335 48.6H70.6215L68.3415 57H66.8415ZM71.5335 57L69.2775 48.6H70.7655L73.1055 57H71.5335ZM34.7436 68.216V66.704H36.5076C36.8756 66.704 37.1756 66.584 37.4076 66.344C37.6476 66.104 37.7676 65.788 37.7676 65.396C37.7676 65.14 37.7076 64.916 37.5876 64.724C37.4676 64.524 37.3036 64.368 37.0956 64.256C36.8876 64.144 36.6476 64.092 36.3756 64.1H34.7436V62.6L36.4116 62.588C37.0036 62.58 37.5276 62.7 37.9836 62.948C38.4396 63.188 38.7956 63.52 39.0516 63.944C39.3076 64.36 39.4356 64.844 39.4356 65.396C39.4356 65.94 39.3116 66.424 39.0636 66.848C38.8156 67.272 38.4756 67.608 38.0436 67.856C37.6116 68.096 37.1116 68.216 36.5436 68.216H34.7436ZM33.2916 71V62.6H34.9356V71H33.2916ZM42.2141 68.024V66.524H43.8941C44.1421 66.524 44.3621 66.472 44.5541 66.368C44.7541 66.264 44.9101 66.12 45.0221 65.936C45.1421 65.752 45.2021 65.544 45.2021 65.312C45.2021 64.952 45.0701 64.66 44.8061 64.436C44.5501 64.212 44.2181 64.1 43.8101 64.1H42.2141V62.6L43.8821 62.588C44.4741 62.58 44.9981 62.696 45.4541 62.936C45.9101 63.168 46.2661 63.488 46.5221 63.896C46.7781 64.304 46.9061 64.776 46.9061 65.312C46.9061 65.84 46.7701 66.312 46.4981 66.728C46.2341 67.136 45.8701 67.456 45.4061 67.688C44.9421 67.912 44.4141 68.024 43.8221 68.024H42.2141ZM40.7621 71V62.6H42.4061V71H40.7621ZM45.3821 71L43.4381 67.628L44.6981 66.728L47.2421 71H45.3821ZM52.5765 71.144C51.7285 71.144 50.9765 70.96 50.3205 70.592C49.6725 70.216 49.1645 69.704 48.7965 69.056C48.4285 68.4 48.2445 67.652 48.2445 66.812C48.2445 65.956 48.4285 65.204 48.7965 64.556C49.1645 63.9 49.6685 63.388 50.3085 63.02C50.9565 62.652 51.7005 62.468 52.5405 62.468C53.3885 62.468 54.1325 62.656 54.7725 63.032C55.4205 63.4 55.9285 63.912 56.2965 64.568C56.6645 65.216 56.8485 65.964 56.8485 66.812C56.8485 67.652 56.6645 68.4 56.2965 69.056C55.9365 69.704 55.4325 70.216 54.7845 70.592C54.1445 70.96 53.4085 71.144 52.5765 71.144ZM52.5765 69.644C53.0885 69.644 53.5365 69.524 53.9205 69.284C54.3125 69.036 54.6165 68.7 54.8325 68.276C55.0565 67.852 55.1685 67.364 55.1685 66.812C55.1685 66.252 55.0565 65.76 54.8325 65.336C54.6085 64.912 54.3005 64.58 53.9085 64.34C53.5165 64.092 53.0605 63.968 52.5405 63.968C52.0365 63.968 51.5845 64.092 51.1845 64.34C50.7925 64.58 50.4845 64.912 50.2605 65.336C50.0365 65.76 49.9245 66.252 49.9245 66.812C49.9245 67.364 50.0365 67.852 50.2605 68.276C50.4845 68.7 50.7965 69.036 51.1965 69.284C51.5965 69.524 52.0565 69.644 52.5765 69.644ZM60.2818 71.168C59.8738 71.168 59.5098 71.104 59.1898 70.976C58.8778 70.84 58.6098 70.668 58.3858 70.46C58.1698 70.252 57.9978 70.028 57.8698 69.788C57.7418 69.548 57.6538 69.316 57.6058 69.092L58.9978 68.564C59.1258 68.916 59.2938 69.188 59.5018 69.38C59.7178 69.572 59.9858 69.668 60.3058 69.668C60.5458 69.668 60.7738 69.612 60.9898 69.5C61.2058 69.388 61.3778 69.208 61.5058 68.96C61.6418 68.712 61.7098 68.392 61.7098 68V62.6H63.3418V68.48C63.3418 68.896 63.2658 69.272 63.1138 69.608C62.9618 69.936 62.7458 70.216 62.4658 70.448C62.1938 70.68 61.8698 70.86 61.4938 70.988C61.1258 71.108 60.7218 71.168 60.2818 71.168ZM65.2829 71V62.6H66.9269V71H65.2829ZM66.5309 71V69.5H70.6469V71H66.5309ZM66.5309 67.472V66.008H70.0949V67.472H66.5309ZM66.5309 64.1V62.6H70.5989V64.1H66.5309ZM76.2973 71.144C75.4813 71.144 74.7573 70.96 74.1253 70.592C73.4933 70.216 72.9973 69.704 72.6373 69.056C72.2773 68.4 72.0973 67.648 72.0973 66.8C72.0973 65.952 72.2773 65.204 72.6373 64.556C72.9973 63.9 73.4893 63.388 74.1133 63.02C74.7453 62.644 75.4693 62.456 76.2853 62.456C76.8613 62.456 77.3973 62.56 77.8933 62.768C78.3893 62.968 78.8213 63.252 79.1893 63.62C79.5653 63.98 79.8533 64.396 80.0533 64.868L78.5293 65.432C78.3933 65.136 78.2133 64.88 77.9893 64.664C77.7653 64.44 77.5093 64.268 77.2213 64.148C76.9333 64.02 76.6213 63.956 76.2853 63.956C75.7973 63.956 75.3613 64.08 74.9773 64.328C74.6013 64.568 74.3053 64.9 74.0893 65.324C73.8813 65.748 73.7773 66.24 73.7773 66.8C73.7773 67.36 73.8853 67.856 74.1013 68.288C74.3173 68.712 74.6173 69.048 75.0013 69.296C75.3853 69.536 75.8253 69.656 76.3213 69.656C76.6653 69.656 76.9773 69.592 77.2573 69.464C77.5453 69.328 77.7973 69.144 78.0133 68.912C78.2373 68.68 78.4173 68.412 78.5533 68.108L80.0773 68.66C79.8773 69.148 79.5893 69.58 79.2133 69.956C78.8453 70.332 78.4133 70.624 77.9173 70.832C77.4213 71.04 76.8813 71.144 76.2973 71.144ZM83.3006 71V63.296H84.9446V71H83.3006ZM80.7806 64.1V62.6H87.4526V64.1H80.7806Z"
					fill="#F7AEF8" />
			</svg>
		{/if}
	</div>
	<div class="text-center text-gray-900 font-display">
		<h3 class="mb-2 text-2xl font-normal sm:text-5xl">{title}</h3>
		<div class="inline-block px-6 py-4 text-base border border-gray-900 rounded-full sm:text-2xl">
			{tags}
		</div>
	</div>
</div>

<style>
	#customCursor {
		position: absolute;
		z-index: 10000;
		pointer-events: none;
		width: 120px;
		height: 120px;
		transform: translate(-50%, -50%);
	}
</style>
